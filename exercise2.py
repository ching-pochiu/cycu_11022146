                            SD_number = SD_number + 1                for whiteInfo in infoTable.find_all('tr', bgcolor='#FFFFFF'):  # 白格                    studentInfo = whiteInfo.find_all('td')                    for imagInfo in studentInfo[1].find_all('img'):  # 考生號碼                        permission = get_number(SD_number, imagInfo['src'])                        print("考生號碼：", permission)                    for departmentTable in studentInfo[3].find_all('tbody'):                        # 0 有無分發錄取 1 系所資料 2 二階甄試正備取                        for departmentInfo in departmentTable.find_all('tr'):                            departRow = departmentInfo.find_all('td')                            # 0存放學校 1為系所                            for departName in departRow[1].find_all('a'):                                try:                                    departmentName = departName.text.split(                                        "\n")                                    print(departmentName[0], departmentName[1])                                except:                                    if "學院" in departmentName[0]:                                        departmentName = departmentName[0].split(                                            "學院")                                        departmentName[0] = departmentName[0] + "學院"                                    elif "大學" in departmentName[0]:                                        departmentName = departmentName[0].split(                                            "大學")                                        departmentName[0] = departmentName[0] + "大學"                            school = departmentName[0]                            department = departmentName[1]                            # 處理正備取                            # 還有特殊區域要處理                            if departRow[2].find_all('div', 'red'):                                for red in departRow[2].find_all('div', 'red'):                                    zhentest = red.text                                    result = '正取'                                    if '-' in zhentest:                                        temp = zhentest                                        zhentest = zhentest.split('-')[1]                                        for specLoop in specials1:                                            if specLoop in temp:                                                zhentest = '外加' + zhentest                                                result = '外加正取'                                                break                                determine = 0                            elif departRow[2].find_all('div', 'green'):                                for green in departRow[2].find_all('div', 'green'):                                    zhentest = green.text                                    result = '備取'                                    if '-' in zhentest:                                        temp = zhentest                                        zhentest = zhentest.split('-')[1]                                        for specLoop in specials1:                                            if specLoop in temp:                                                zhentest = '外加' + zhentest                                                result = '外加備取'                                                break                                determine = 0                            else:                                zhentest = '無'                                result = '無'                                determine = 2                            # 有無分發錄取                            for admission in departRow[0].find_all('img'):                                print('錄取該系所')                                determine = 1                            print(list(permission))                            print(                                "permission:", permission, "\nschool:", school, "\ndepartment", department, "\narea:", area, "\ncountry:", country, "\nzhentest:", zhentest, "\ndetermine:", determine, "\nresult:", result                            )                            try:                                cursor.execute("INSERT INTO crosscheck.dbo.[113Cross_check](SD_number, sd_year, area, County, school, department, Permission, Zhentest, Determine,result) VALUES('{}','{}','{}','{}','{}','{}','{}','{}','{}','{}')".format(                                    SD_number, str(sd_year), str(area), str(country), str(school), str(department), str(permission), str(zhentest), str(determine), str(result)))                                conn.commit()                            except Exception as e:                                print('error:', e)                            SD_number = SD_number + 1            else:                print("考區：", compareArea, "比對不符，跳過此區")                continue        print('該考區爬取完畢')        examLink.clear()
    print("該縣市爬取成功，將相關存放Link的list清除")
    def clear(): return os.system('cls')  # 清除console
    clear()
    areaLink.clear()
    examLink.clear()
    areaDict.clear()
    flagNum = flagNum + 1
    compareNum = compareNum + 1
print('finish!')
